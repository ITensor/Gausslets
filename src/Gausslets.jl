module Gausslets

using AutoVectors
using Interp

# zero centered basic gausslet
mutable struct gausslet
    cfg::AutoVector{Float64}	# coefs in front of exp(-1/2 (x/w)^2), which is not normalized
    sp::Float64		# spacing of gaussians
    w::Float64		# (width of each gaussian)/sp;  normally 1.0
    interp::Interpolator
    function gausslet(cf,n,coarse)
	sp = coarse/n
	w = 1.0
	fac = 1/sqrt(2 * pi * coarse)/w
	cfg = AutoVector(0.0)
	for i=arange(cf)
	    cfg[i] = cf[i] * fac
	end
	dat = AutoVector(0.0)
	spac = sp/40
	for i=mini(cfg)*45:maxi(cfg)*45
	    x = i * spac
	    ii = round(Int64,x/sp)
	    dat[i] = sum(i->cfg[i] * exp(-0.5*((x/sp-i)/w)^2),ii-12:ii+12)
	end
	interp = Interpolator(dat,spac)
	new(cfg,sp,w,interp)
    end
end

function gausslet(cf::AutoVector{Float64},spacing=1.0)
    gausslet(cf,3,spacing)
end
function gausslet(cf1::AutoVector{Float64},cf2::AutoVector{Float64},spacing=1.0)
    cfboth = transc(cf1,cf2,3)
    gausslet(cfboth,9,spacing)
end
function gausslet(cf1::AutoVector{Float64},cf2::AutoVector{Float64},cf3::AutoVector{Float64},spacing=1.0)
    cfboth = transc(cf1,cf2,3)
    cftrip = transc(cfboth,cf3,9)
    gausslet(cftrip,27,spacing)
end

function (g::gausslet)(x::Real)
    g.interp(x)
end

#non-interpolated evaluation of the gausslet function at x
function fg(g::gausslet,x) 
    return g(x)
    ii = round(Int64,x/g.sp)
    abs(ii) > maxi(g.cfg)+20 && return 0.0
    sum(i->g.cfg[i] * exp(-0.5*((x/g.sp-i)/g.w)^2),ii-12:ii+12)
end


########## Start of specific gausslets and ternary wavelet
# c = ternary wavelets, cf = gausslet coefs
# These are all Type I site centered symmetric ternary wavelets, as devised by Evenbly and White

c220 = AutoVector(0.0)
c220[0]=7.484170156161815465859e-01
c220[1]=4.276668660663894551919e-01
c220[2]=1.710667464265557820767e-01
c220[3]=-8.553337321327789103839e-02
c220[4]=-2.138334330331947275959e-02
for i=-4:-1
    c220[i] = c220[-i]
end

c212 = AutoVector(0.0)
c212[0]=6.969234250586758986207e-01
c212[1]=4.927992798267443904376e-01
c212[2]=1.020620726159657540915e-01
c212[3]=-5.978657793452506705581e-02
c212[4]=-1.751108325308438002008e-02
for i=-4:-1
    c212[i] = c212[-i]
end

c322 = AutoVector(0.0)
c322[0]=7.088184744967755026560e-01
c322[1]=4.779214265933680198319e-01
c322[2]=1.227066102069279846205e-01
c322[3]=-5.978657793452506705581e-02
c322[4]=-3.861365889708359016288e-02
c322[5]=1.487785323337637060573e-02
c322[6]=-5.947524719049802017625e-03
c322[7]=0.0
c322[8]=4.580380530369796138390e-04
for i=-8:-1
    c322[i] = c322[-i]
end

c432 = AutoVector(0.0)
c432[0]=6.654518154646826230888e-01
c432[1]=4.969889091605377601130e-01
c432[2]=1.522417442806670745131e-01
c432[3]=-5.939199777784238155480e-02
c432[4]=-6.723544965306701580524e-02
c432[5]=-9.391741678102148472349e-03
c432[6]=1.573580479699663776599e-02
c432[7]=5.202112344308778796975e-03
c432[8]=1.324480078011608579154e-04
c432[9]=-3.945801566826855010193e-04
c432[10]=-5.877532725198454943122e-04
for i=-10:-1
    c432[i] = c432[-i]
end

c652 = AutoVector(0.0)
c652[0]=6.501872253871460904683e-01
c652[1]=4.940964120768750181395e-01
c652[2]=1.780984528432653307078e-01
c652[3]=-5.502349892625515739009e-02
c652[4]=-9.091868927454020175579e-02
c652[5]=-2.232926569795845160960e-02
c652[6]=2.287228875757822919810e-02
c652[7]=2.076921020735121291067e-02
c652[8]=1.875552900495757810687e-04
c652[9]=-4.667396365731449011966e-03
c652[10]=-2.982747265182722042592e-03
c652[11]=1.228043257281568376934e-05
c652[12]=4.958110781866748780847e-04
c652[13]=2.506428079037953132500e-04
c652[14]=1.904530104763033365020e-04
c652[15]=-9.568264253846065376009e-05
c652[16]=-2.403524118691195554653e-05
for i=-16:-1
    c652[i] = c652[-i]
end

c872 = AutoVector(0.0)
c872[0]=6.405114155921801661454e-01
c872[1]=4.939883211006996356153e-01
c872[2]=1.883467419220767551732e-01
c872[3]=-5.096425099142167375140e-02
c872[4]=-1.002087947361240391932e-01
c872[5]=-3.198768294883890966202e-02
c872[6]=2.642677984804660256911e-02
c872[7]=2.964161300599306536682e-02
c872[8]=3.227961262516882974170e-03
c872[9]=-8.518281555442893634548e-03
c872[10]=-6.846248914061121821108e-03
c872[11]=1.096044668196249093938e-04
c872[12]=1.721448564128159914247e-03
c872[13]=1.121513967521634224616e-03
c872[14]=1.704882398607878663001e-04
c872[15]=-2.998652087043123427819e-04
c872[16]=-1.452851719807417651131e-04
c872[17]=-9.207082321168426699148e-05
c872[18]=5.777632107310375429805e-05
c872[19]=1.798105776102425046230e-05
c872[20]=7.320286085070872203669e-06
c872[21]=-4.180178956187327086538e-06
c872[22]=-1.193525492220034994887e-06
for i=-22:-1
    c872[i] = c872[-i]
end

c1092 = AutoVector(0.0)
c1092[0]=6.339678630846934972809e-01
c1092[1]=4.937325799533404462265e-01
c1092[2]=1.947092720525292208567e-01
c1092[3]=-4.753996243300718780138e-02
c1092[4]=-1.058504106212748144882e-01
c1092[5]=-3.886742005430104117304e-02
c1092[6]=2.800455999919556464955e-02
c1092[7]=3.602675799888625329536e-02
c1092[8]=6.475547896335909283527e-03
c1092[9]=-1.146069592381025089093e-02
c1092[10]=-1.052113605585069082650e-02
c1092[11]=-4.029241837835782839690e-04
c1092[12]=3.301983027767256246509e-03
c1092[13]=2.392617491538371319417e-03
c1092[14]=1.341991885868512813805e-04
c1092[15]=-7.538488057218801006999e-04
c1092[16]=-4.329594781529207792175e-04
c1092[17]=-1.478738121133826762599e-04
c1092[18]=1.677730970038756853910e-04
c1092[19]=7.054009715493215927208e-05
c1092[20]=4.629247300599195785494e-05
c1092[21]=-3.183210170080977333562e-05
c1092[22]=-1.027065571877989698043e-05
c1092[23]=-5.965666564327656838749e-06
c1092[24]=3.464863024504088454535e-06
c1092[25]=9.680025867172271769409e-07
c1092[26]=5.103695558473031122342e-07
c1092[27]=-2.386702849384894669685e-07
c1092[28]=-5.580613524062022857463e-08
for i=-28:-1
    c1092[i] = c1092[-i]
end



csum(f) = sum(i->f[i],arange(f))/sqrt(3.0)

#@show csum(c212)
#@show csum(c432)
#@show csum(c652)
#@show csum(c861)

c212left = AutoVector(0.0)
c212left[-4]=-1.453920883520663394634e-01
c212left[-3]=-4.963996399133721952188e-01
c212left[-2]=8.474071914746780509742e-01
c212left[-1]=-5.978657793452506705581e-02
c212left[0]=-8.455098936288137407146e-02
c212left[1]=-5.978657793452506705581e-02
c212left[2]=-6.146199118595711226173e-03
c212left[3]=3.600360086627804781159e-03
c212left[4]=1.054521054659898336145e-03

function makerightmidhigh(l)
    r = AutoVector(0.0)
    m = AutoVector(0.0)
    h = AutoVector(0.0)
    for i=arange(l)
	r[-i] = l[i]
    end
    r5 = sqrt(0.5)
    for i=mini(r):maxi(l)+3
	m[i] = r5 * (l[i-3] + r[i])
	h[i] = r5 * (l[i-3] - r[i])
    end
    # @show avdot(m,m)
    # @show avdot(h,h)
    # @show avdot(m,h)
    (r,m,h)
end
(c212right,c212mid,c212high) = makerightmidhigh(c212left)

c220left = AutoVector(0.0)
c220left[-4]=-1.090139138138542374545e-01
c220left[-3]=-4.360556552554169498182e-01
c220left[-2]=8.721113105108338996364e-01
c220left[-1]=-8.553337321327789103839e-02
c220left[0]=-1.496834031232363093171e-01
c220left[1]=-8.553337321327789103839e-02
c220left[2]=-1.677757837805498925248e-02
c220left[3]=8.388789189027494626241e-03
c220left[4]=2.097197297256873656560e-03
(c220right,c220mid,c220high) = makerightmidhigh(c220left)

c432left = AutoVector(0.0)
c432left[-10]=-2.451156162699331169797e-03
c432left[-9]=-1.645550314990335485825e-03
c432left[-8]=5.523588991128972275944e-04
c432left[-7]=3.815057111821847473591e-02
c432left[-6]=7.667168816016856362419e-02
c432left[-5]=-4.287540497774070395286e-02
c432left[-4]=-1.357817745306483119483e-01
c432left[-3]=-4.933902676746802972913e-01
c432left[-2]=8.324442831411442175028e-01
c432left[-1]=-9.895654653478684606047e-02
c432left[0]=-1.596536607191399360241e-01
c432left[1]=-1.676055770340070645663e-02
c432left[2]=-1.328947717910510014588e-02
c432left[3]=2.189230736763266871286e-03
c432left[4]=1.539460294510816551729e-02
c432left[5]=1.019397482043304268743e-03
c432left[6]=-1.569016803910001671518e-03
c432left[7]=-1.506152533836566463246e-04
c432left[8]=-1.587959820930742554233e-05
c432left[9]=4.730742616297546818852e-05
c432left[10]=7.046754397266906260557e-05
(c432right,c432mid,c432high) = makerightmidhigh(c432left)

c652left = AutoVector(0.0)
c652left[-16]=-6.973946336012093262790e-05
c652left[-15]=-2.776280084571871499806e-04
c652left[-14]=5.526090061941818959460e-04
c652left[-13]=-2.236751606482727002315e-04
c652left[-12]=-2.346957747337475318687e-03
c652left[-11]=7.570696298076418072476e-03
c652left[-10]=-7.057658735529583855820e-03
c652left[-9]=-2.704572111533540936071e-02
c652left[-8]=6.695280274428612465339e-02
c652left[-7]=-1.202043491639873326650e-02
c652left[-6]=-1.100180025056247364820e-01
c652left[-5]=2.720062982284602340149e-01
c652left[-4]=-1.705380859733622563891e-01
c652left[-3]=-5.170516712575977376960e-01
c652left[-2]=7.008386947129347962629e-01
c652left[-1]=-4.787782357730237657243e-02
c652left[0]=4.658647294922301874079e-02
c652left[1]=-3.263358292040124431670e-01
c652left[2]=2.835026982822402092270e-02
c652left[3]=4.849132906204484661961e-02
c652left[4]=7.873456807361894834755e-02
c652left[5]=-1.100318843489437815422e-04
c652left[6]=-1.846223939608306544706e-02
c652left[7]=-1.292807692493365517819e-02
c652left[8]=-2.190253946352110898184e-03
c652left[9]=3.067923300120051683809e-03
c652left[10]=1.378896199471840236452e-03
c652left[11]=4.453876041732592648970e-04
c652left[12]=-3.102626630591155644524e-04
c652left[13]=-9.966633211562079798683e-05
c652left[14]=-3.281918028199953652718e-05
c652left[15]=1.648819248104546563271e-05
c652left[16]=4.141792832057914145081e-06
(c652right,c652mid,c652high) = makerightmidhigh(c652left)

c872left = AutoVector(0.0)
c872left[-22]=-2.851600168946602209600e-06
c872left[-21]=-9.987385351542402507089e-06
c872left[-20]=1.748980576702855302599e-05
c872left[-19]=2.529774375013098940709e-05
c872left[-18]=7.617793729707751843105e-05
c872left[-17]=-1.116446106311258637429e-04
c872left[-16]=-3.444987566867433606995e-05
c872left[-15]=3.016827047178589322186e-04
c872left[-14]=-1.240833404345729033594e-03
c872left[-13]=1.312314739937116673941e-03
c872left[-12]=2.619928129160503775175e-03
c872left[-11]=-2.727127869489070465553e-03
c872left[-10]=-6.078689282808552987415e-03
c872left[-9]=-1.869314201483263499879e-02
c872left[-8]=5.355272936019650312203e-02
c872left[-7]=-6.419433543899539041091e-03
c872left[-6]=-1.072034757103360908349e-01
c872left[-5]=2.888873279943761501431e-01
c872left[-4]=-1.740242309262881829637e-01
c872left[-3]=-5.243255341736468276605e-01
c872left[-2]=6.883377597025960906629e-01
c872left[-1]=-5.139674075513859070144e-02
c872left[0]=4.700866064343024430194e-02
c872left[1]=-3.210827127840027749175e-01
c872left[2]=3.101232037601354929500e-02
c872left[3]=4.256238502839873521444e-02
c872left[4]=1.032788684260403927132e-01
c872left[5]=-4.465240653474727616644e-03
c872left[6]=-2.569499211062669438189e-02
c872left[7]=-2.413839406990339523703e-02
c872left[8]=-2.170036802295598562381e-03
c872left[9]=7.178946330026752824042e-03
c872left[10]=4.448074903452290919524e-03
c872left[11]=1.128467658668764738420e-03
c872left[12]=-1.339778661174875654057e-03
c872left[13]=-6.087165348997959476702e-04
c872left[14]=-2.388174216676875400418e-04
c872left[15]=1.854948856106363412397e-04
c872left[16]=6.737396304472231407263e-05
c872left[17]=2.875687563177790159352e-05
c872left[18]=-1.750959063153879616460e-05
c872left[19]=-5.310059975054767378746e-06
c872left[20]=-1.531937777956992731858e-06
c872left[21]=8.747983326313122154246e-07
c872left[22]=2.497725866500591134533e-07
(c872right,c872mid,c872high) = makerightmidhigh(c872left)

c1092left = AutoVector(0.0)
c1092left[-28]=-1.249419062733154786840e-07
c1092left[-27]=-5.343484232053556514784e-07
c1092left[-26]=1.142643993110867406650e-06
c1092left[-25]=9.878490461023859260422e-07
c1092left[-24]=2.713431920038454187996e-06
c1092left[-23]=-2.570460935787951802401e-06
c1092left[-22]=-1.196028691141822102817e-05
c1092left[-21]=-3.834295943612241215347e-05
c1092left[-20]=6.374385638043966733100e-05
c1092left[-19]=2.050478761607917268436e-05
c1092left[-18]=-7.052911669578509637304e-05
c1092left[-17]=4.064972608076856829719e-04
c1092left[-16]=-4.232323588384434842707e-04
c1092left[-15]=-1.154177831984237125145e-03
c1092left[-14]=2.107386362187677327741e-03
c1092left[-13]=3.906775833222403429329e-04
c1092left[-12]=-3.129142820851471993104e-03
c1092left[-11]=1.045191542746476313120e-02
c1092left[-10]=-1.253392964284869349462e-02
c1092left[-9]=-4.305188223136707862362e-02
c1092left[-8]=9.929708348347995497426e-02
c1092left[-7]=-2.389028989028772812899e-02
c1092left[-6]=-1.615363758147658606845e-01
c1092left[-5]=3.598200957516972536066e-01
c1092left[-4]=-1.782809462784022800134e-01
c1092left[-3]=-5.012372047589712011999e-01
c1092left[-2]=5.985592616249921276128e-01
c1092left[-1]=-2.733261710261526006307e-02
c1092left[0]=1.176396547403824926189e-01
c1092left[1]=-3.879154206436791122403e-01
c1092left[2]=4.130502813503345930035e-02
c1092left[3]=3.858435128534319561469e-02
c1092left[4]=1.382474719253873163354e-01
c1092left[5]=-1.089273522995176362685e-02
c1092left[6]=-3.373828597535437262965e-02
c1092left[7]=-4.058093069833238485128e-02
c1092left[8]=-8.750580585333437441938e-04
c1092left[9]=1.335237051162409803110e-02
c1092left[10]=9.875114532780013802197e-03
c1092left[11]=1.755599293580773436807e-03
c1092left[12]=-3.597888886741163025017e-03
c1092left[13]=-1.924369529232510818990e-03
c1092left[14]=-6.934759839626551946938e-04
c1092left[15]=7.309446792188021979776e-04
c1092left[16]=3.059907556283422624052e-04
c1092left[17]=1.588865763053324007940e-04
c1092left[18]=-1.198579843976231600402e-04
c1092left[19]=-4.146121652492211270077e-05
c1092left[20]=-2.447407431040190791929e-05
c1092left[21]=1.514252541454293825884e-05
c1092left[22]=4.504881417825199932214e-06
c1092left[23]=2.408198459157023957911e-06
c1092left[24]=-1.276936377628555906536e-06
c1092left[25]=-3.338257900515015347509e-07
c1092left[26]=-1.139799820006143069843e-07
c1092left[27]=5.330183681549677302693e-08
c1092left[28]=1.246309114126081738627e-08
(c1092right,c1092mid,c1092high) = makerightmidhigh(c1092left)


cf432 = AutoVector(0.0)
cf432[0]=1.52094338883413275109172583
cf432[1]=1.15198688060176029431495320
cf432[2]=-4.121578440844901052168e-02
cf432[3]=-3.518350208287448527978e-01
cf432[4]=-1.010019297480388885759e-01
cf432[5]=2.289702751566537666154e-02
cf432[6]=1.032918136581714848590e-01
cf432[7]=-6.595045046041941879288e-02
cf432[8]=3.017750387011653094133e-02
cf432[9]=-1.030745000089144217819e-02
cf432[10]=7.910453058955299859401e-04
cf432[11]=2.232218994277958114169e-03
cf432[12]=-1.913705783241699047063e-03
cf432[13]=4.147764295946750864539e-04
cf432[14]=-2.664482195184813728403e-04
cf432[15]=3.734200572766647243559e-04
cf432[16]=-2.319952818105304654354e-04
cf432[17]=1.476775358128409746882e-04
cf432[18]=-8.621851217034304693814e-05
cf432[19]=3.495889300086134155870e-05
cf432[20]=-1.401220330813606501426e-05
cf432[21]=5.513016180758649831381e-06
cf432[22]=-1.948441653595394963664e-06
cf432[23]=4.565350798358671832202e-07
cf432[24]=-2.803855182868468349636e-08
cf432[25]=1.443070503576741485997e-08
cf432[26]=4.397652049654308419601e-09
cf432[27]=-1.965108654598054564522e-08
cf432[28]=7.321849369520241146679e-09
cf432[29]=-2.797295407158631110794e-09
cf432[30]=1.665991916369844328322e-09
cf432[31]=-2.709159133014326613449e-10
cf432[32]=-1.049012506043442573940e-16
cf432[33]=-3.615732339546861214598e-17
cf432[34]=-7.916167962323626117028e-17
cf432[35]=6.334709799445793369837e-17
cf432[36]=-1.650747532788728613654e-16
cf432[37]=2.007762865687973142198e-17
cf432[38]=7.138535990354872933046e-16
cf432[39]=1.033906795812449835350e-15
cf432[40]=6.432634309180230830752e-16
cf432[41]=-9.062838621663574761853e-16
cf432[42]=-1.262696549485762373383e-15
cf432[43]=-9.523206294791629814401e-16
cf432[44]=-3.270240392665979045608e-16
cf432[45]=-1.797177561318589421132e-16
cf432[46]=-3.234184294053198835407e-16
cf432[47]=1.153806962312560707747e-16
cf432[48]=1.608894792359630548052e-16
cf432[49]=1.885620846240612466521e-16
cf432[50]=-3.182871999678429334720e-17
cf432[51]=-5.459394468633022544164e-17
cf432[52]=1.302262083015463274936e-17
cf432[53]=-1.113769110229414846667e-17
cf432[54]=1.148067606639838693755e-17
cf432[55]=-8.509764163240959722256e-18
cf432[56]=2.687901166882258529214e-18
cf432[57]=3.717081796075196336424e-19
cf432[58]=4.767108666485369910688e-19
cf432[59]=1.498612297654538058441e-19
cf432[60]=-4.881177133969928591251e-19
cf432[61]=1.433681520377348060663e-19
cf432[62]=-9.471033233294276795688e-20
cf432[63]=9.760093539531512257789e-20
cf432[64]=-4.630117254978598550258e-20
cf432[65]=2.089490783056969935325e-20
cf432[66]=-9.716035185317939145482e-21
cf432[67]=3.725933241161551446595e-21
cf432[68]=-5.882932320109593166365e-22
cf432[69]=-5.259430344320944506046e-22
cf432[70]=3.099589915128932180890e-22
cf432[71]=-2.889704203961241109655e-22
cf432[72]=2.495402035966243076058e-22
cf432[73]=-1.157451783917988865964e-22
cf432[74]=6.077411269444175070789e-23
cf432[75]=-3.496933362369638860350e-23
cf432[76]=1.450138934238313249995e-23
cf432[77]=-5.836994539066701346830e-24
cf432[78]=2.345422789395414228588e-24
cf432[79]=-8.329942896088432139408e-25
cf432[80]=2.199181196714848696819e-25
cf432[81]=-1.791863818478867285610e-26
cf432[82]=6.816253064868086060155e-27
cf432[83]=2.604845992341116101686e-27
cf432[84]=-7.719436941281319095010e-27
cf432[85]=2.293419450111007325448e-27
cf432[86]=-7.697859610263051660018e-28
cf432[87]=6.009252765415894317593e-28
cf432[88]=-1.382435619577732461338e-28
cf432[89]=2.691791815288406374370e-29
cf432[90]=-1.393103695381987600299e-29
cf432[91]=1.207722127104453531083e-30
for i=-91:-1
    cf432[i] = cf432[-i]
end

cf652 = AutoVector(0.0)
cf652[0]=1.6320153169995224225489856
cf652[1]=9.397103630041332435839e-01
cf652[2]=2.354725190493886190909e-01
cf652[3]=-3.932915969820916853767e-01
cf652[4]=-2.376673454608851175922e-01
cf652[5]=5.831576834943676869344e-02
cf652[6]=5.429701963071594240892e-02
cf652[7]=9.069106956998456987046e-02
cf652[8]=-7.949746043043603203087e-02
cf652[9]=3.356771659557051094357e-02
cf652[10]=-3.258494735636407271617e-02
cf652[11]=2.091646467287704701552e-02
cf652[12]=-8.924109329996287554403e-03
cf652[13]=3.144555019068441655580e-03
cf652[14]=9.010395318815981959527e-04
cf652[15]=-1.967308103094176681476e-03
cf652[16]=1.440596393244990703067e-03
cf652[17]=-7.695482401317233024862e-04
cf652[18]=3.759658131422559233916e-04
cf652[19]=-2.245073291889746154811e-04
cf652[20]=1.322445791679810922442e-04
cf652[21]=-7.138943907965492324196e-05
cf652[22]=3.760318789008913636748e-05
cf652[23]=-1.724768833509916444374e-05
cf652[24]=7.019700960891258102682e-06
cf652[25]=-3.275498081933460801438e-06
cf652[26]=1.796890045285305550907e-06
cf652[27]=-9.806066668767915334843e-07
cf652[28]=4.044561746194414819392e-07
cf652[29]=-1.006787662132638448998e-07
cf652[30]=3.066469025415046051690e-09
cf652[31]=1.600821939088489475880e-08
cf652[32]=-7.691392206875153690010e-09
cf652[33]=1.128097317364325483630e-09
cf652[34]=-5.559802460396609733200e-10
cf652[35]=2.290763293397782836749e-10
cf652[36]=2.621163237702449545631e-11
cf652[37]=-1.102719521628479244614e-11
cf652[38]=-7.838370192093010031594e-17
cf652[39]=-1.234997204332030186369e-16
cf652[40]=-7.970454835139829105445e-17
cf652[41]=-3.063445999562898178587e-17
cf652[42]=2.796470850225003431291e-18
cf652[43]=1.174459295367946598974e-17
cf652[44]=6.623304582443232581244e-18
cf652[45]=2.675685919421163925781e-17
cf652[46]=9.391236748443977391747e-18
cf652[47]=7.328233360164191586098e-18
cf652[48]=-1.202295003667544708803e-17
cf652[49]=-5.605685618758719400007e-18
cf652[50]=-3.525630780659449667277e-18
cf652[51]=-3.643607195320510760853e-18
cf652[52]=-5.565784887034908165686e-19
cf652[53]=-2.164636833633330920609e-18
cf652[54]=2.804186725739849495788e-18
cf652[55]=5.940505893700573814305e-19
cf652[56]=1.752196569554431904735e-18
cf652[57]=1.289740121216760817401e-18
cf652[58]=-3.021883004095228846765e-19
cf652[59]=-1.912282603252357400046e-18
cf652[60]=-4.361552926795186264448e-18
cf652[61]=-2.171206070124679062924e-18
cf652[62]=-4.328931149601574301168e-19
cf652[63]=1.467718673580913137248e-18
cf652[64]=8.112945747514661487781e-19
cf652[65]=-1.543962805651192607776e-19
cf652[66]=-2.752896616154303680137e-19
cf652[67]=-3.354970472018213371148e-19
cf652[68]=2.168722938012341279304e-19
cf652[69]=-5.278761880260950809493e-20
cf652[70]=1.180931145837114809886e-19
cf652[71]=-7.200708466757265590186e-20
cf652[72]=2.466862917283977718622e-20
cf652[73]=-1.991280020059576754898e-20
cf652[74]=5.988128609876682421101e-21
cf652[75]=1.747459746279133976097e-21
cf652[76]=-1.035422943455419440100e-21
cf652[77]=9.505678060442265927941e-22
cf652[78]=-9.480733126448912093994e-22
cf652[79]=6.201389726189098995605e-22
cf652[80]=-4.371671036828075939848e-22
cf652[81]=2.974184349164196030635e-22
cf652[82]=-1.805016005610380957890e-22
cf652[83]=1.027605134586928903597e-22
cf652[84]=-5.570984083048599202671e-23
cf652[85]=3.146744018304958624283e-23
cf652[86]=-1.740754899266838047993e-23
cf652[87]=9.121353782049951726098e-24
cf652[88]=-4.669436732461872450638e-24
cf652[89]=2.186737046274964049026e-24
cf652[90]=-9.681733390197187444247e-25
cf652[91]=4.340017610764381206467e-25
cf652[92]=-1.987756503569557289103e-25
cf652[93]=9.219441069311155886895e-26
cf652[94]=-3.820359690705679055972e-26
cf652[95]=1.562627589700562440588e-26
cf652[96]=-6.852503637308088640376e-27
cf652[97]=2.294009754862893470172e-27
cf652[98]=-7.523443569698768259580e-28
cf652[99]=3.261251893882496932637e-28
cf652[100]=-5.798896197691506096055e-29
cf652[101]=6.190084581758838972304e-31
cf652[102]=-3.706311342226906857338e-30
cf652[103]=-4.175433314143578151561e-30
cf652[104]=2.657083534552941761989e-30
for i=-104:-1
    cf652[i] = cf652[-i]
end

cf872 = AutoVector(0.0)
cf872[0]=1.5512242410212684246375483
cf872[1]=9.585766267806114012512e-01
cf872[2]=2.755974865234243243094e-01
cf872[3]=-3.706437697683526755368e-01
cf872[4]=-2.738574549670301499200e-01
cf872[5]=2.093254391784337841076e-03
cf872[6]=9.612130190030550518733e-02
cf872[7]=1.112426256003016418412e-01
cf872[8]=-6.623030901422846365105e-02
cf872[9]=9.887493110785662816227e-03
cf872[10]=-4.534889648522558568253e-02
cf872[11]=3.267289439583588510256e-02
cf872[12]=-1.166767162605946941184e-02
cf872[13]=1.005162978543936570301e-02
cf872[14]=-3.806239844839114705785e-03
cf872[15]=-6.200197386921517487869e-04
cf872[16]=1.007968480511346241694e-03
cf872[17]=-1.681911256702108575329e-03
cf872[18]=1.624277534084707695334e-03
cf872[19]=-1.020768071973996832202e-03
cf872[20]=6.284265970578943384068e-04
cf872[21]=-3.735202912357661972643e-04
cf872[22]=2.137994097918106002165e-04
cf872[23]=-1.250316997252872599305e-04
cf872[24]=7.244665590074770173022e-05
cf872[25]=-4.231932555891808261958e-05
cf872[26]=2.434414435703396581952e-05
cf872[27]=-1.360972529984790208670e-05
cf872[28]=6.994902338082735531882e-06
cf872[29]=-2.921899543042996029494e-06
cf872[30]=1.065644088340260965975e-06
cf872[31]=-4.808161652676369411090e-07
cf872[32]=2.536341631796663455623e-07
cf872[33]=-1.306164375680734825677e-07
cf872[34]=6.677361120579429639122e-08
cf872[35]=-3.240387408041427540822e-08
cf872[36]=1.679860501900875408060e-08
cf872[37]=-8.040021622607130142152e-09
cf872[38]=2.294477138332905804072e-09
cf872[39]=-3.780329828931665743108e-10
cf872[40]=1.443246418284764107284e-10
cf872[41]=-3.704777973953932068253e-11
cf872[42]=-1.029455818217655444849e-11
cf872[43]=3.903446665619265653570e-12
cf872[44]=1.769136293405856591493e-15
cf872[45]=5.862942313708565362075e-16
cf872[46]=3.363992778417570441085e-16
cf872[47]=4.394406239181485303604e-16
cf872[48]=1.242792077969072606465e-16
cf872[49]=1.713715623655891842818e-16
cf872[50]=-1.127988850880008038227e-16
cf872[51]=9.769064518041065457491e-17
cf872[52]=-3.114072942981402874492e-17
cf872[53]=2.840877720969843977197e-17
cf872[54]=-9.260590600765293598290e-18
cf872[55]=-3.419148087879178870035e-19
cf872[56]=2.068599984733041312380e-17
cf872[57]=-7.860507741040508116377e-19
cf872[58]=1.620333603163795009613e-17
cf872[59]=4.908272054347570784496e-18
cf872[60]=9.874587413214869185149e-18
cf872[61]=5.016680021696785194084e-18
cf872[62]=1.585985229225840189964e-18
cf872[63]=-2.597427713616134466442e-19
cf872[64]=5.642893372989734293732e-18
cf872[65]=1.281370053232421772934e-17
cf872[66]=1.902363870214369084498e-17
cf872[67]=1.060717518352508801304e-17
cf872[68]=1.469955037502376447921e-18
cf872[69]=-6.985669171352159666510e-18
cf872[70]=-4.917259673640296137431e-18
cf872[71]=-5.655938540552588246448e-19
cf872[72]=1.723387785924942554144e-18
cf872[73]=1.709917199803201234982e-18
cf872[74]=-7.650635403598492287386e-19
cf872[75]=-9.934058595878176160006e-20
cf872[76]=-7.211670830188407285946e-19
cf872[77]=4.987462137463811389741e-19
cf872[78]=-1.442550210121964425453e-19
cf872[79]=2.077771007112836916451e-19
cf872[80]=-1.037870244496504542211e-19
cf872[81]=1.282492096626011791942e-20
cf872[82]=-9.895916989620192152698e-21
cf872[83]=-1.257297001221753856428e-20
cf872[84]=2.102357210777139367460e-20
cf872[85]=-1.276772095802909128864e-20
cf872[86]=9.637082300479430279930e-21
cf872[87]=-7.038520644930356030653e-21
cf872[88]=3.836532597675066349991e-21
cf872[89]=-2.240272792077845744793e-21
cf872[90]=1.376914385555389983636e-21
cf872[91]=-7.813649511130452796622e-22
cf872[92]=4.845034960434291729404e-22
cf872[93]=-3.053557210520378259013e-22
cf872[94]=1.718257974952930584774e-22
cf872[95]=-9.264150023323157900278e-23
cf872[96]=4.951238718639757794016e-23
cf872[97]=-2.599397250833808255480e-23
cf872[98]=1.320271727449297031536e-23
cf872[99]=-6.526845506214522837819e-24
cf872[100]=3.485911918405822176140e-24
cf872[101]=-1.968596760591185384583e-24
cf872[102]=1.110341956517173255719e-24
cf872[103]=-5.980437525632760049830e-25
cf872[104]=2.855364053356933897743e-25
cf872[105]=-1.365953260618163886160e-25
cf872[106]=6.827575130612969085219e-26
cf872[107]=-2.828533267160428264208e-26
cf872[108]=1.050917051315843867725e-26
cf872[109]=-4.941356875374282795351e-27
cf872[110]=2.411406857091690541621e-27
cf872[111]=-1.118734705960646145734e-27
cf872[112]=5.491327259091844040860e-28
cf872[113]=-2.480024060059978291018e-28
cf872[114]=1.173280662980157863885e-28
cf872[115]=-5.634930359211022920832e-29
cf872[116]=1.786138039942587410059e-29
cf872[117]=-4.457236412678787196545e-30
cf872[118]=1.934047989185846175710e-30
for i=-118:-1
    cf872[i] = cf872[-i]
end

cf1092 = AutoVector(0.0)
cf1092[0]=1.5055517020505458175378186
cf1092[1]=9.702917745805685979193e-01
cf1092[2]=2.926328324807071238756e-01
cf1092[3]=-3.512142100110780321069e-01
cf1092[4]=-2.954194232330311299941e-01
cf1092[5]=-2.823281051618899274489e-02
cf1092[6]=1.129386798833114250822e-01
cf1092[7]=1.258657434070511747635e-01
cf1092[8]=-5.198065226060147775539e-02
cf1092[9]=-7.974743722879026825699e-03
cf1092[10]=-5.386747594823527645927e-02
cf1092[11]=3.493470496207330740473e-02
cf1092[12]=-7.418200959410535572553e-03
cf1092[13]=1.429949018583579700979e-02
cf1092[14]=-6.722610137710927546244e-03
cf1092[15]=-1.156032446276761918177e-03
cf1092[16]=8.035403758097588199934e-04
cf1092[17]=-2.430216497610616591773e-03
cf1092[18]=3.103612065433395506966e-03
cf1092[19]=-2.170116504593984574267e-03
cf1092[20]=1.767321012791003880059e-03
cf1092[21]=-1.334272983387090844748e-03
cf1092[22]=8.354277446615439561910e-04
cf1092[23]=-5.459516855288107523432e-04
cf1092[24]=3.483231734138820904662e-04
cf1092[25]=-2.129490818657875048472e-04
cf1092[26]=1.337323810885673156417e-04
cf1092[27]=-8.221015176322931390863e-05
cf1092[28]=4.844766362697261749759e-05
cf1092[29]=-2.724068355502199928384e-05
cf1092[30]=1.509324932473009240463e-05
cf1092[31]=-8.307065435250142225273e-06
cf1092[32]=4.211475966057759796723e-06
cf1092[33]=-2.066097100216814474565e-06
cf1092[34]=1.037742077806785927616e-06
cf1092[35]=-4.686210682424503135172e-07
cf1092[36]=1.973494631802111533380e-07
cf1092[37]=-9.044220344774718893050e-08
cf1092[38]=4.224311047522120637286e-08
cf1092[39]=-2.181791384718947131743e-08
cf1092[40]=1.059181855970391643394e-08
cf1092[41]=-3.669514819333807560242e-09
cf1092[42]=1.622653646493201414082e-09
cf1092[43]=-9.374427895549122469843e-10
cf1092[44]=3.559067702491192703479e-10
cf1092[45]=-1.768586279192052484577e-10
cf1092[46]=1.047906223782958210261e-10
cf1092[47]=-2.447457368147987262506e-11
cf1092[48]=-2.194524405102682891303e-12
cf1092[49]=1.197201505901068297764e-12
cf1092[50]=-1.530899674454319138531e-14
cf1092[51]=-7.543897279554997408735e-15
cf1092[52]=-2.208019185359353528565e-14
cf1092[53]=1.584717459318284207702e-14
cf1092[54]=-4.727879652002295403613e-15
cf1092[55]=7.434251054962843773159e-15
cf1092[56]=-4.407987463381179475641e-15
cf1092[57]=4.411774979068626721140e-16
cf1092[58]=-3.121318877009549805487e-16
cf1092[59]=-9.519266397407364032047e-16
cf1092[60]=1.170983498192831482146e-15
cf1092[61]=-1.014258737385112569113e-15
cf1092[62]=6.820386364242393625549e-16
cf1092[63]=-6.661184971587495239378e-16
cf1092[64]=2.695243321165493890423e-16
cf1092[65]=-2.972262515993353668793e-16
cf1092[66]=6.359952705817730925186e-17
cf1092[67]=-1.297080120571458452891e-16
cf1092[68]=2.847319643198303340506e-17
cf1092[69]=-3.524889628185951808242e-17
cf1092[70]=3.179224115571396156061e-17
cf1092[71]=7.992260098344700264359e-18
cf1092[72]=2.921969118155358038266e-17
cf1092[73]=7.392231805430052866345e-18
cf1092[74]=1.984155312078279795498e-18
cf1092[75]=-1.531136694117216481443e-17
cf1092[76]=-8.091330045800750691135e-18
cf1092[77]=-2.683168107462423996874e-18
cf1092[78]=5.856815216153220343358e-18
cf1092[79]=4.072110622342033315966e-18
cf1092[80]=-1.755504271835769752153e-19
cf1092[81]=-1.341165851625073861760e-18
cf1092[82]=-1.986690979388686238292e-18
cf1092[83]=9.084143668545129450604e-19
cf1092[84]=-1.291357751407182762298e-20
cf1092[85]=7.859451200792791831242e-19
cf1092[86]=-4.195741752676862500315e-19
cf1092[87]=4.011878098459897977998e-20
cf1092[88]=-1.671315618224221810457e-19
cf1092[89]=5.279653225494385294011e-20
cf1092[90]=4.525434889155381677034e-20
cf1092[91]=-1.244454636401906708556e-20
cf1092[92]=2.884072568141005120459e-20
cf1092[93]=-3.841403055502825864638e-20
cf1092[94]=2.296668513521742628312e-20
cf1092[95]=-1.946027909078530984449e-20
cf1092[96]=1.609380730038451273533e-20
cf1092[97]=-9.877468296978347000623e-21
cf1092[98]=6.981988043997806841439e-21
cf1092[99]=-4.912473834557615584453e-21
cf1092[100]=2.977037915273224211770e-21
cf1092[101]=-1.916942112413122986893e-21
cf1092[102]=1.234239268640875850045e-21
cf1092[103]=-7.312459095585484272226e-22
cf1092[104]=4.379641328427186017159e-22
cf1092[105]=-2.621958275750320590385e-22
cf1092[106]=1.506209902162738764988e-22
cf1092[107]=-8.508336992214527722760e-23
cf1092[108]=4.779302494161306024744e-23
cf1092[109]=-2.652040333693232154065e-23
cf1092[110]=1.430123284963931866698e-23
cf1092[111]=-7.670917725344193161887e-24
cf1092[112]=4.144234526272738863868e-24
cf1092[113]=-2.158577617961910095063e-24
cf1092[114]=1.135989346993905488292e-24
cf1092[115]=-6.080895986016484119262e-25
cf1092[116]=3.053920885728673415562e-25
cf1092[117]=-1.583375506133576072009e-25
cf1092[118]=8.432484265373806337698e-26
cf1092[119]=-4.000643605896291268978e-26
cf1092[120]=1.967325322558713993203e-26
cf1092[121]=-1.024549129644345984385e-26
cf1092[122]=4.546118418712684855037e-27
cf1092[123]=-2.060608351013616333255e-27
cf1092[124]=1.031533863465528350511e-27
cf1092[125]=-4.285053145168249614666e-28
cf1092[126]=1.836646234947396428103e-28
cf1092[127]=-8.973095391667930316638e-29
cf1092[128]=3.521699671092300302463e-29
cf1092[129]=-1.597809153871637365460e-29
cf1092[130]=8.231371822180941511537e-30
cf1092[131]=-2.793498356808885303694e-30
cf1092[132]=1.197298740531939530910e-30
for i=-132:-1
    cf1092[i] = cf1092[-i]
end

function tofloat(c)
    a = AutoVector(0.0)
    for i=arange(c)
	a[i] = Float64(c[i])
    end
    a
end

function transc(o,c,k)
    oc = AutoVector(0.0)
    for i=arange(c), j=arange(o)
	oc[k*i+j] += sqrt(3.0) * c[i] * o[j]
    end
    oc
end

cfset = [0,0,0,cf432,0,cf652,0,cf872,0,cf1092]
cset = [0,0,0,c432,0,c652,0,c872,0,c1092]
clset = [0,0,0,c432left,0,c652left,0,c872left,0,c1092left]
crset = [0,0,0,c432right,0,c652right,0,c872right,0,c1092right]
cmset = [0,0,0,c432mid,0,c652mid,0,c872mid,0,c1092mid]
chset = [0,0,0,c432high,0,c652high,0,c872high,0,c1092high]

# LR = left-right, MH = mid-high
function gaussletFamilyLR(order1,order2)
    global cfset,cset,clset,crset
    cf = cfset[order1]
    c2,c2l,c2r =  cset[order2], clset[order2], crset[order2]
    (gausslet(cf,c2), gausslet(cf,c2l), gausslet(cf,c2r))
 end

function gaussletFamilyLR(order1,order2,order3)
    global cfset,cset,clset,crset
    cf = cfset[order1]
    c2,c2l,c2r =  cset[order2], clset[order2], crset[order2]
    c3,c3l,c3r =  cset[order3], clset[order3], crset[order3]
    (gausslet(cf,c2,c3), gausslet(cf,c2,c3l), gausslet(cf,c2,c3r),
     gausslet(cf,c2l,1/3),gausslet(cf,c2r,1/3))
 end

function gaussletFamilyMH(order1,order2)
    global cfset,cset,cmset,chset
    cf = cfset[order1]
    c2,c2m,c2h =  cset[order2], cmset[order2], chset[order2]
    (gausslet(cf,c2), gausslet(cf,c2m), gausslet(cf,c2h))
 end

function gaussletFamilyMH(order1,order2,order3)
    global cfset,cset,cmset,chset
    cf = cfset[order1]
    c2,c2m,c2h =  cset[order2], cmset[order2], chset[order2]
    c3,c3m,c3h =  cset[order3], cmset[order3], chset[order3]
    (gausslet(cf,c2,c3), gausslet(cf,c2,c3m), gausslet(cf,c2,c3h),
     gausslet(cf,c2m,1/3),gausslet(cf,c2h,1/3))
 end


export gausslet, fg, transc,
	c220, c212, c322, c432,  c652, c872, c1092, 
	c212left, c220left, c432left, c652left, c872left, c1092left, cf432, cf652,
	cf872, cf1092,  c652right, c1092right,  c872right, c1092mid,c1092high,
	c652mid,c652high,c432mid,c432high,c432left,c432right,
	gaussletFamilyLR, gaussletFamilyMH


end

